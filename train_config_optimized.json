{
    "training": {
        "description": "优化版训练配置 - 三阶段训练参数",
        
        "phase1_epochs": 50,
        "phase1_description": "世界模型预训练 - 学习基础动力学。目标：收敛到 Loss ≈ 1.0",
        
        "phase2_epochs": 200,
        "phase2_description": "风险预测训练 - 学习冲突检测。目标：State Loss ≈ 0.8-1.0, Conflict Loss ≈ 0.1-0.5",
        
        "phase3_epochs": 100,
        "phase3_description": "端到端微调 - 整体优化。目标：稳定收敛，生成有效控制动作",
        
        "batch_size": 64,
        "batch_size_note": "建议范围: 32-128。显存 < 4GB 用 32, 4-8GB 用 64, > 8GB 用 128",
        
        "learning_rate": 0.0003,
        "learning_rate_note": "基础学习率，使用 CosineAnnealingWarmRestarts 动态调整",
        "learning_rate_schedule": {
            "T_0": 50,
            "T_mult": 2,
            "eta_min": 1e-6,
            "note": "余弦退火: 从 0.0003 逐步降至 1e-6，周期倍增"
        },
        
        "weight_decay": 0.0001,
        "weight_decay_note": "L2 正则化系数，防止过拟合",
        
        "save_path": "models/traffic_controller_v1.pth",
        "save_path_note": "训练完成后保存模型的路径"
    },
    
    "model": {
        "description": "改进后的神经网络架构配置",
        
        "node_dim": 9,
        "node_dim_note": "输入节点特征维度: [speed, position, accel, ...]",
        
        "edge_dim": 4,
        "edge_dim_note": "交互边特征维度: [distance, relative_speed, ...]",
        
        "gnn_hidden_dim": 64,
        "gnn_hidden_dim_note": "GNN 中间隐层维度",
        
        "gnn_output_dim": 256,
        "gnn_output_dim_note": "GNN 输出嵌入维度 (全局表示)",
        
        "gnn_layers": 3,
        "gnn_layers_note": "GNN 层数。改进: 每层添加残差连接 + LayerNorm",
        
        "gnn_heads": 4,
        "gnn_heads_note": "多头注意力头数 (GAT)",
        
        "world_hidden_dim": 128,
        "world_hidden_dim_note": "世界模型隐层维度",
        
        "future_steps": 5,
        "future_steps_note": "预测的未来时间步数 (Phase 2 输出: [N, 5, 257])",
        
        "controller_hidden_dim": 128,
        "controller_hidden_dim_note": "控制器网络隐层维度",
        
        "global_dim": 16,
        "global_dim_note": "全局上下文特征维度 (交通指标)",
        
        "top_k": 5,
        "top_k_note": "控制的车辆数 (选择影响力最高的 K 辆车)",
        
        "ttc_threshold": 2.0,
        "ttc_threshold_note": "碰撞时间 (秒) 阈值，低于此值触发安全干预",
        
        "thw_threshold": 1.5,
        "thw_threshold_note": "车头时距 (秒) 阈值，低于此值表示危险跟车",
        
        "max_accel": 2.0,
        "max_accel_note": "最大加速度 (m/s²)",
        
        "max_decel": -3.0,
        "max_decel_note": "最大减速度 (m/s²)",
        
        "emergency_decel": -5.0,
        "emergency_decel_note": "紧急制动减速度 (m/s²)",
        
        "max_lane_change_speed": 5.0,
        "max_lane_change_speed_note": "换道时的最大速度 (m/s)",
        
        "cost_limit": 0.1,
        "cost_limit_note": "干预成本限制 (评测指标: 越低越好)",
        
        "lambda_lr": 0.01,
        "lambda_lr_note": "拉格朗日乘数的学习率",
        
        "cache_timeout": 10,
        "cache_timeout_note": "GNN 缓存失效时间 (步数)",
        
        "device": "cuda",
        "device_note": "计算设备: cuda (GPU) 或 cpu"
    },
    
    "optimization": {
        "description": "优化策略配置 (仅用于文档，在 train.py 中实现)",
        
        "mixed_precision": {
            "enabled": true,
            "note": "混合精度训练 (FP16 + FP32)，速度提升 2-3 倍"
        },
        
        "curriculum_learning": {
            "enabled": true,
            "difficulty_schedule": "0.30 → 0.50 → 0.70 → 1.00",
            "note": "难度从简单逐步增加到复杂场景"
        },
        
        "data_augmentation": {
            "enabled": true,
            "augmentation_prob": 0.3,
            "feature_scale": "±10%",
            "noise_std": 0.05,
            "note": "随机缩放特征并添加高斯噪声，提升鲁棒性"
        },
        
        "multitask_loss": {
            "enabled": true,
            "weights": {
                "state": 1.0,
                "conflict": 1.5,
                "safety": 2.0
            },
            "note": "多任务加权损失: 安全权重最高"
        },
        
        "gradient_clipping": {
            "enabled": true,
            "max_norm": 1.0,
            "note": "防止梯度爆炸"
        },
        
        "early_stopping": {
            "enabled": true,
            "patience": 15,
            "note": "连续 15 个 epoch 无改善则停止"
        }
    },
    
    "parallel": {
        "num_workers": 8,
        "num_workers_note": "数据加载线程数",
        
        "base_port": 8813,
        "base_port_note": "SUMO 仿真基础端口",
        
        "env_per_worker": 2,
        "env_per_worker_note": "每个 worker 的环境数"
    },
    
    "notes": {
        "version": "v2.0 - 优化版",
        "update_date": "2025-01-10",
        "key_improvements": [
            "✓ 学习率动态调整 (CosineAnnealingWarmRestarts)",
            "✓ GNN 残差连接 + LayerNorm",
            "✓ 多任务加权损失函数",
            "✓ 课程学习 (难度逐步增加)",
            "✓ 混合精度训练 (FP16 + FP32)",
            "✓ 数据增强",
            "✓ 梯度裁剪和缩放",
            "✓ 早停机制"
        ],
        "expected_improvement": "8-12% OCR + 20-25% 综合得分",
        "training_time": "~15-20 分钟 (GPU: A100/V100)"
    }
}
